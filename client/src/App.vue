<script setup>
import axios from 'axios';
import Cookies from 'js-cookie';
import { onBeforeMount } from 'vue';

// –£–±–∏—Ä–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ App.vue
// –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –≥–¥–µ –Ω—É–∂–Ω—ã

onBeforeMount(() => {
  // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º axios —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
  const csrfToken = Cookies.get("csrftoken");
  if (csrfToken) {
    axios.defaults.headers.common['X-CSRFToken'] = csrfToken;
  }
  axios.defaults.withCredentials = true;
  
  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç—ã
  axios.defaults.timeout = 10000; // 10 —Å–µ–∫—É–Ω–¥
})
</script>

<template>
  <div id="app">
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container">
        <router-link class="navbar-brand" to="/">
          üèÜ –¢—É—Ä–Ω–∏—Ä–Ω–∞—è –°–∏—Å—Ç–µ–º–∞
        </router-link>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
          <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav me-auto">
            <li class="nav-item">
              <router-link class="nav-link" to="/">
                <i class="bi bi-house me-1"></i>–ì–ª–∞–≤–Ω–∞—è
              </router-link>
            </li>
            <li class="nav-item">
              <router-link class="nav-link" to="/teams">
                <i class="bi bi-people me-1"></i>–ö–æ–º–∞–Ω–¥—ã
              </router-link>
            </li>
            <li class="nav-item">
              <router-link class="nav-link" to="/players">
                <i class="bi bi-person me-1"></i>–ò–≥—Ä–æ–∫–∏
              </router-link>
            </li>
            <li class="nav-item">
              <router-link class="nav-link" to="/tournaments">
                <i class="bi bi-trophy me-1"></i>–¢—É—Ä–Ω–∏—Ä—ã
              </router-link>
            </li>
            <li class="nav-item">
              <router-link class="nav-link" to="/categories">
                <i class="bi bi-tags me-1"></i>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏
              </router-link>
            </li>
            <li class="nav-item">
              <router-link class="nav-link" to="/matches">
                <i class="bi bi-controller me-1"></i>–ú–∞—Ç—á–∏
              </router-link>
            </li>
          </ul>
          
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="/admin" target="_blank">
                <i class="bi bi-gear me-1"></i>–ê–¥–º–∏–Ω–∫–∞
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <main class="main-content">
      <router-view/>
    </main>
  </div>
</template>

<style scoped>
.navbar-brand {
  font-weight: bold;
  font-size: 1.3rem;
}

.nav-link {
  transition: all 0.3s ease;
}

.nav-link:hover {
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 5px;
}

.nav-link.router-link-active {
  background-color: rgba(255, 255, 255, 0.2);
  border-radius: 5px;
  font-weight: bold;
}

.main-content {
  min-height: calc(100vh - 76px);
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
</style>